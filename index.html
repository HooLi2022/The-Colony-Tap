<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç –ó–∞—Å–µ–ª–µ–Ω–∏–µ –ó–µ–º–ª–∏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0B0B2B, #1B1B4B);
            font-family: 'Segoe UI', system-ui, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            padding: 16px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            text-align: center;
        }

        .earth {
            position: relative;
            width: min(280px, 60vw);
            height: min(280px, 60vw);
            margin: 16px auto;
            border-radius: 50%;
            background: #2B3B4B;
            box-shadow: 0 0 40px rgba(100,150,255,0.3);
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .earth:active {
            transform: scale(0.98);
        }

        .earth-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0%;
            background: linear-gradient(180deg, #4CAF50, #2E7D32);
            transition: height 0.3s ease-out;
            border-radius: 0 0 50% 50%;
        }

        .earth-image {
            position: absolute;
            inset: 0;
            background: url('https://upload.wikimedia.org/wikipedia/commons/9/97/The_earth_at_night.jpg') center/cover;
            opacity: 0;
            transition: opacity 0.3s;
            mask-image: radial-gradient(circle, black, transparent);
        }

        .progress-section {
            margin: 16px 0;
        }

        .progress-bar {
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.3s;
        }

        .counter {
            font-size: clamp(2.5rem, 10vw, 4rem);
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 16px;
            margin: 16px 0;
            border: 2px solid rgba(255,215,0,0.3);
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
        }

        .name-section {
            margin: 20px 0;
            min-height: 80px;
        }

        .name-input-group {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .name-input {
            padding: 12px 20px;
            border-radius: 30px;
            border: none;
            width: 250px;
            font-size: 1.1em;
            background: rgba(255,255,255,0.95);
        }

        .name-button {
            padding: 12px 30px;
            border-radius: 30px;
            border: none;
            background: #ffd700;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            transition: 0.2s;
        }

        .name-button:hover {
            background: #ffed4a;
            transform: scale(1.05);
        }

        .greeting {
            font-size: 1.4em;
            padding: 12px 24px;
            background: rgba(255,255,255,0.15);
            border-radius: 40px;
            display: inline-block;
            border: 2px solid #ffd700;
        }

        .greeting-name {
            color: #ffd700;
            font-weight: bold;
        }

        .hidden {
            display: none !important;
        }

        .click-button {
            background: #ffd700;
            color: #333;
            border: none;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            padding: 20px 40px;
            border-radius: 60px;
            cursor: pointer;
            font-weight: bold;
            margin: 16px 0;
            transition: all 0.2s;
            box-shadow: 0 0 30px rgba(255,215,0,0.5);
            width: 100%;
            max-width: 400px;
        }

        .click-button:not(:disabled):hover {
            transform: scale(1.05);
            background: #ffed4a;
            box-shadow: 0 0 50px rgba(255,215,0,0.8);
        }

        .click-button:not(:disabled):active {
            transform: scale(0.95);
        }

        .click-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(255,255,255,0.15);
            border-radius: 16px;
            padding: 12px;
            font-size: 0.9rem;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #ffd700;
            margin-top: 4px;
        }

        .top-players {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 16px;
            margin-top: 20px;
        }

        .top-title {
            font-size: 1.5rem;
            color: #ffd700;
            margin-bottom: 16px;
        }

        .top-list {
            list-style: none;
        }

        .top-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            margin: 6px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            transition: 0.2s;
        }

        .top-item.current {
            border: 2px solid #ffd700;
            background: rgba(255,215,0,0.15);
        }

        .top-rank {
            width: 32px;
            height: 32px;
            background: #ffd700;
            color: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .top-rank-1 { background: #FFD700; box-shadow: 0 0 15px #FFD700; }
        .top-rank-2 { background: #C0C0C0; box-shadow: 0 0 15px #C0C0C0; }
        .top-rank-3 { background: #CD7F32; box-shadow: 0 0 15px #CD7F32; }

        .top-name {
            flex: 1;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .top-score {
            font-weight: bold;
            color: #ffd700;
            margin-left: 8px;
        }

        .last-clicker {
            background: rgba(255,255,255,0.2);
            padding: 12px;
            border-radius: 10px;
            margin-top: 16px;
        }

        #lastClickerName {
            color: #ffd700;
            font-weight: bold;
        }

        .cheater-alert {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff4444;
            color: white;
            padding: 16px 24px;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 4px 20px rgba(255,0,0,0.5);
            z-index: 1000;
            animation: slideDown 0.3s;
            display: none;
        }

        .god-mode-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255,215,0,0.9);
            color: #333;
            padding: 8px 16px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(255,215,0,0.5);
            z-index: 1000;
            border: 2px solid white;
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏ —Å–æ–∑–¥–∞—Ç–µ–ª—è */
        .creator-panel-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255,215,0,0.9);
            color: #333;
            padding: 12px 20px;
            border-radius: 40px;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .creator-panel-btn:hover {
            transform: scale(1.05);
            background: #ffd700;
        }

        .creator-panel-btn .notification {
            background: #ff4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            margin-left: 8px;
        }

        /* –ü–∞–Ω–µ–ª—å —Å–æ–∑–¥–∞—Ç–µ–ª—è */
        .creator-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a3a, #2a2a4a);
            border: 3px solid #ffd700;
            border-radius: 30px;
            padding: 30px;
            z-index: 2000;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255,215,0,0.3);
            display: none;
        }

        .creator-panel.show {
            display: block;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255,215,0,0.3);
            padding-bottom: 15px;
        }

        .panel-header h2 {
            color: #ffd700;
            font-size: 1.8rem;
        }

        .close-panel {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        }

        .close-panel:hover {
            background: rgba(255,0,0,0.3);
        }

        .banned-list {
            margin-top: 20px;
        }

        .banned-item {
            background: rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 5px solid #ff4444;
            transition: 0.2s;
        }

        .banned-item:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }

        .banned-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .banned-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #ffd700;
        }

        .banned-score {
            background: rgba(255,215,0,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 1.1rem;
        }

        .banned-reason {
            color: #ffaaaa;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .banned-time {
            color: #aaa;
            font-size: 0.8rem;
            margin-bottom: 15px;
        }

        .banned-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            flex: 1;
            min-width: 100px;
        }

        .unban-btn {
            background: #4CAF50;
            color: white;
        }

        .unban-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .warn-btn {
            background: #ffd700;
            color: #333;
        }

        .warn-btn:hover {
            background: #ffed4a;
            transform: scale(1.05);
        }

        .delete-btn {
            background: #ff4444;
            color: white;
        }

        .delete-btn:hover {
            background: #cc0000;
            transform: scale(1.05);
        }

        .empty-list {
            text-align: center;
            padding: 30px;
            color: #aaa;
            font-size: 1.2rem;
        }

        .panel-stats {
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            text-align: center;
        }

        .stat-item {
            color: #ffd700;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #aaa;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1500;
            display: none;
        }

        .backdrop.show {
            display: block;
        }

        @keyframes slideDown {
            from { transform: translate(-50%, -100%); opacity: 0; }
            to { transform: translate(-50%, 0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .notification-pulse {
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div class="cheater-alert" id="cheaterAlert">üö´ –û–±–Ω–∞—Ä—É–∂–µ–Ω —á–∏—Ç–µ—Ä! –î–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –ø–∞–Ω–µ–ª–∏ —Å–æ–∑–¥–∞—Ç–µ–ª—è -->
    <div class="creator-panel-btn" id="creatorPanelBtn">
        <span>üëë –ü–∞–Ω–µ–ª—å —Å–æ–∑–¥–∞—Ç–µ–ª—è</span>
        <span class="notification" id="bannedNotification">0</span>
    </div>
    
    <!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ -->
    <div class="backdrop" id="backdrop"></div>
    
    <!-- –ü–∞–Ω–µ–ª—å —Å–æ–∑–¥–∞—Ç–µ–ª—è -->
    <div class="creator-panel" id="creatorPanel">
        <div class="panel-header">
            <h2>üëë –ü–∞–Ω–µ–ª—å —Å–æ–∑–¥–∞—Ç–µ–ª—è</h2>
            <button class="close-panel" id="closePanel">√ó</button>
        </div>
        
        <div class="panel-stats">
            <div>
                <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤</div>
                <div class="stat-number" id="totalPlayers">0</div>
            </div>
            <div>
                <div class="stat-label">–ó–∞–±–∞–Ω–µ–Ω–æ</div>
                <div class="stat-number" id="totalBanned">0</div>
            </div>
            <div>
                <div class="stat-label">–û–Ω–ª–∞–π–Ω</div>
                <div class="stat-number" id="totalOnline">0</div>
            </div>
        </div>
        
        <div class="banned-list" id="bannedList">
            <div class="empty-list">–ó–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–µ—Ç</div>
        </div>
    </div>

    <div class="god-mode-badge" id="godModeBadge">üëë –†–µ–∂–∏–º —Å–æ–∑–¥–∞—Ç–µ–ª—è</div>

    <div class="container">
        <h1>üåç –ó–∞—Å–µ–ª–µ–Ω–∏–µ –ó–µ–º–ª–∏</h1>
        <p>–¶–µ–ª—å: 8 –º–ª—Ä–¥ –∫–ª–∏–∫–æ–≤</p>
        
        <div class="earth" id="earth">
            <div class="earth-fill" id="earthFill"></div>
            <div class="earth-image" id="earthImage"></div>
        </div>
        
        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="earth-target">
                <span id="currentPop">0</span> / 8 000 000 000
            </div>
        </div>
        
        <div class="counter" id="counter">0</div>
        
        <div class="name-section">
            <div id="nameInputGroup" class="name-input-group">
                <input type="text" id="username" class="name-input" placeholder="–í–∞—à–µ –∏–º—è" maxlength="20" autocomplete="off">
                <button id="saveNameBtn" class="name-button">–ù–∞—á–∞—Ç—å</button>
            </div>
            <div id="greeting" class="greeting hidden">
                <span>–ò–≥—Ä–æ–∫: <span id="displayName" class="greeting-name"></span></span>
            </div>
        </div>
        
        <button id="clickBtn" class="click-button" disabled>üëÜ –ó–ê–°–ï–õ–ò–¢–¨</button>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div>–û–Ω–ª–∞–π–Ω</div>
                <div class="stat-value" id="onlineCount">0</div>
            </div>
            <div class="stat-card">
                <div>–¢–≤–æ–π –≤–∫–ª–∞–¥</div>
                <div class="stat-value" id="userScore">0</div>
            </div>
            <div class="stat-card">
                <div>–û—Å—Ç–∞–ª–æ—Å—å</div>
                <div class="stat-value" id="remaining">8 –º–ª—Ä–¥</div>
            </div>
        </div>
        
        <div class="top-players">
            <div class="top-title">üèÜ –¢–æ–ø –∑–∞—Å–µ–ª—å–Ω–∏–∫–æ–≤</div>
            <div id="topList" class="top-list">
                <div class="top-item" style="justify-content: center;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
        </div>
        
        <div class="last-clicker">
            –ü–æ—Å–ª–µ–¥–Ω–∏–π: <span id="lastClickerName">–Ω–∏–∫—Ç–æ</span>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        (function() {
            'use strict';
            
            // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
            const CONFIG = {
                TARGET: 8000000000,
                DB_URL: 'https://the-colony-tap-default-rtdb.firebaseio.com',
                STORAGE: {
                    NAME: 'wc_name',
                    SCORE: 'wc_score',
                    ID: 'wc_id',
                    NAME_SET: 'wc_set',
                    CHEAT_COUNT: 'wc_cheat',
                    GOD_MODE: 'wc_god'
                },
                LIMITS: {
                    MAX_CLICKS_PER_SECOND: 20,
                    MAX_CLICKS_PER_MINUTE: 300,
                    MAX_SCORE_GROWTH: 1000,
                    CHECK_INTERVAL: 5000,
                    BAN_THRESHOLD: 3
                },
                CREATOR_SECRET: 'ILoveMyGame'
            };

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
            firebase.initializeApp({
                apiKey: "AIzaSyA_gNkLMsTxneTwyg5bDxKBN9osRIUrPaE",
                authDomain: "the-colony-tap.firebaseapp.com",
                databaseURL: CONFIG.DB_URL,
                projectId: "the-colony-tap",
                storageBucket: "the-colony-tap.firebasestorage.app",
                messagingSenderId: "433438733616",
                appId: "1:433438733616:web:76095a36161b32590d44f5"
            });

            const db = firebase.database();
            
            // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
            const el = {
                earth: document.getElementById('earth'),
                earthFill: document.getElementById('earthFill'),
                earthImage: document.getElementById('earthImage'),
                progressFill: document.getElementById('progressFill'),
                counter: document.getElementById('counter'),
                currentPop: document.getElementById('currentPop'),
                remaining: document.getElementById('remaining'),
                onlineCount: document.getElementById('onlineCount'),
                userScore: document.getElementById('userScore'),
                lastClickerName: document.getElementById('lastClickerName'),
                topList: document.getElementById('topList'),
                nameInputGroup: document.getElementById('nameInputGroup'),
                greeting: document.getElementById('greeting'),
                displayName: document.getElementById('displayName'),
                username: document.getElementById('username'),
                saveNameBtn: document.getElementById('saveNameBtn'),
                clickBtn: document.getElementById('clickBtn'),
                cheaterAlert: document.getElementById('cheaterAlert'),
                godModeBadge: document.getElementById('godModeBadge'),
                // –ù–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–∞–Ω–µ–ª–∏
                creatorPanelBtn: document.getElementById('creatorPanelBtn'),
                creatorPanel: document.getElementById('creatorPanel'),
                backdrop: document.getElementById('backdrop'),
                closePanel: document.getElementById('closePanel'),
                bannedList: document.getElementById('bannedList'),
                bannedNotification: document.getElementById('bannedNotification'),
                totalPlayers: document.getElementById('totalPlayers'),
                totalBanned: document.getElementById('totalBanned'),
                totalOnline: document.getElementById('totalOnline')
            };

            // –°–æ—Å—Ç–æ—è–Ω–∏–µ
            const state = {
                username: '',
                score: 0,
                playerId: null,
                nameSet: false,
                onlineRef: null,
                playerRef: null,
                loading: true,
                
                // –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∏—Ç–µ—Ä–æ–≤
                clickTimes: [],
                lastScore: 0,
                lastCheck: Date.now(),
                cheatCount: 0,
                banned: false,
                
                // –†–µ–∂–∏–º —Å–æ–∑–¥–∞—Ç–µ–ª—è
                godMode: false,
                
                // –î–∞–Ω–Ω—ã–µ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
                allPlayers: {},
                bannedPlayers: {},
                
                initComplete: false,
                securityLevel: 'high'
            };

            // ===== –•—Ä–∞–Ω–∏–ª–∏—â–µ =====
            const storage = {
                get: key => {
                    try { return localStorage.getItem(CONFIG.STORAGE[key]); } 
                    catch { return null; }
                },
                set: (key, value) => {
                    try { localStorage.setItem(CONFIG.STORAGE[key], value); } 
                    catch (e) { console.warn('Storage error:', e); }
                },
                remove: key => {
                    try { localStorage.removeItem(CONFIG.STORAGE[key]); } 
                    catch (e) { console.warn('Storage error:', e); }
                }
            };

            // ===== –ü–ê–ù–ï–õ–¨ –°–û–ó–î–ê–¢–ï–õ–Ø =====
            const creatorPanel = {
                // –û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å
                open() {
                    if (!state.godMode) {
                        alert('‚ùå –¢–æ–ª—å–∫–æ –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è!');
                        return;
                    }
                    el.creatorPanel.classList.add('show');
                    el.backdrop.classList.add('show');
                    this.updateBannedList();
                },
                
                // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å
                close() {
                    el.creatorPanel.classList.remove('show');
                    el.backdrop.classList.remove('show');
                },
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö
                updateBannedList() {
                    if (!state.godMode) return;
                    
                    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ—Ö –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö
                    const banned = Object.entries(state.allPlayers)
                        .filter(([id, data]) => data.banned === true)
                        .map(([id, data]) => ({ id, ...data }))
                        .sort((a, b) => (b.cheatCount || 0) - (a.cheatCount || 0));
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
                    el.totalPlayers.textContent = Object.keys(state.allPlayers).length;
                    el.totalBanned.textContent = banned.length;
                    el.totalOnline.textContent = document.getElementById('onlineCount').textContent;
                    el.bannedNotification.textContent = banned.length;
                    
                    if (banned.length === 0) {
                        el.bannedList.innerHTML = '<div class="empty-list">‚ú® –ó–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–µ—Ç</div>';
                        return;
                    }
                    
                    // –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫
                    el.bannedList.innerHTML = banned.map(player => {
                        const banTime = new Date(player.banTime || Date.now()).toLocaleString();
                        const reason = player.banReason || '–ß–∏—Ç–µ—Ä—Å—Ç–≤–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–Ω)';
                        
                        return `
                            <div class="banned-item" data-player-id="${player.id}">
                                <div class="banned-header">
                                    <span class="banned-name">${player.name || '–ê–Ω–æ–Ω–∏–º'}</span>
                                    <span class="banned-score">üëÜ ${(player.score || 0).toLocaleString()}</span>
                                </div>
                                <div class="banned-reason">üö´ –ü—Ä–∏—á–∏–Ω–∞: ${reason}</div>
                                <div class="banned-time">‚è∞ –ó–∞–±–∞–Ω–µ–Ω: ${banTime}</div>
                                <div class="banned-actions">
                                    <button class="action-btn unban-btn" onclick="creatorTools.unbanPlayer('${player.id}')">‚úÖ –†–∞–∑–±–∞–Ω–∏—Ç—å</button>
                                    <button class="action-btn warn-btn" onclick="creatorTools.warnPlayer('${player.id}')">‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å</button>
                                    <button class="action-btn delete-btn" onclick="creatorTools.deletePlayer('${player.id}')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                                </div>
                            </div>
                        `;
                    }).join('');
                },
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –±–∞–Ω–µ
                notifyNewBan(playerName) {
                    if (!state.godMode) return;
                    
                    el.cheaterAlert.style.background = '#ffd700';
                    el.cheaterAlert.style.color = '#333';
                    el.cheaterAlert.textContent = `üëë –ù–æ–≤—ã–π –∑–∞–±–∞–Ω–µ–Ω–Ω—ã–π: ${playerName}`;
                    el.cheaterAlert.style.display = 'block';
                    
                    // –ú–∏–≥–∞–µ–º –∫–Ω–æ–ø–∫–æ–π
                    el.creatorPanelBtn.classList.add('notification-pulse');
                    
                    setTimeout(() => {
                        el.cheaterAlert.style.display = 'none';
                        el.cheaterAlert.style.background = '#ff4444';
                        el.cheaterAlert.style.color = 'white';
                    }, 3000);
                    
                    setTimeout(() => {
                        el.creatorPanelBtn.classList.remove('notification-pulse');
                    }, 10000);
                }
            };

            // ===== –ò–ù–°–¢–†–£–ú–ï–ù–¢–´ –°–û–ó–î–ê–¢–ï–õ–Ø =====
            window.creatorTools = {
                // –†–∞–∑–±–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞
                unbanPlayer(playerId) {
                    if (!state.godMode) return;
                    
                    db.ref('players/' + playerId).update({
                        banned: false,
                        banReason: null,
                        banTime: null,
                        cheatCount: 0
                    }).then(() => {
                        alert(`‚úÖ –ò–≥—Ä–æ–∫ —Ä–∞–∑–±–∞–Ω–µ–Ω!`);
                        creatorPanel.updateBannedList();
                    });
                },
                
                // –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –∏–≥—Ä–æ–∫–∞
                warnPlayer(playerId) {
                    if (!state.godMode) return;
                    
                    const player = state.allPlayers[playerId];
                    const newCheatCount = (player.cheatCount || 0) + 1;
                    
                    db.ref('players/' + playerId).update({
                        cheatCount: newCheatCount,
                        lastWarn: Date.now()
                    }).then(() => {
                        alert(`‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (${newCheatCount}/3)`);
                        
                        // –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥ –ª–∏–º–∏—Ç–∞ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–Ω
                        if (newCheatCount >= CONFIG.LIMITS.BAN_THRESHOLD) {
                            this.banPlayer(playerId, '–¢—Ä–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è');
                        }
                    });
                },
                
                // –ó–∞–±–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –≤—Ä—É—á–Ω—É—é
                banPlayer(playerId, reason = '–†—É—á–Ω–æ–π –±–∞–Ω –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è') {
                    if (!state.godMode) return;
                    
                    db.ref('players/' + playerId).update({
                        banned: true,
                        banReason: reason,
                        banTime: Date.now(),
                        online: false
                    }).then(() => {
                        alert(`üö´ –ò–≥—Ä–æ–∫ –∑–∞–±–∞–Ω–µ–Ω!`);
                        creatorPanel.updateBannedList();
                        
                        // –£–¥–∞–ª—è–µ–º –∏–∑ –æ–Ω–ª–∞–π–Ω
                        db.ref('onlineUsers').orderByChild('playerId').equalTo(playerId).once('value', snap => {
                            snap.forEach(child => child.ref.remove());
                        });
                    });
                },
                
                // –£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –∏–∑ –±–∞–∑—ã
                deletePlayer(playerId) {
                    if (!state.godMode) return;
                    
                    if (confirm('‚ö†Ô∏è –¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –Ω–∞–≤—Å–µ–≥–¥–∞?')) {
                        db.ref('players/' + playerId).remove().then(() => {
                            alert(`üóëÔ∏è –ò–≥—Ä–æ–∫ —É–¥–∞–ª–µ–Ω`);
                            creatorPanel.updateBannedList();
                        });
                    }
                },
                
                // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ—Ö –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö
                clearAllBanned() {
                    if (!state.godMode) return;
                    
                    if (confirm('‚ö†Ô∏è –†–∞–∑–±–∞–Ω–∏—Ç—å –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤?')) {
                        const updates = {};
                        Object.keys(state.allPlayers).forEach(id => {
                            updates[id] = { ...state.allPlayers[id], banned: false, cheatCount: 0 };
                        });
                        
                        db.ref('players').update(updates).then(() => {
                            alert('‚úÖ –í—Å–µ —Ä–∞–∑–±–∞–Ω–µ–Ω—ã');
                            creatorPanel.updateBannedList();
                        });
                    }
                },
                
                // –†–∞–∑–±–∞–Ω —Å–∞–º–æ–≥–æ —Å–µ–±—è
                unbanMyself() {
                    state.banned = false;
                    state.cheatCount = 0;
                    state.godMode = true;
                    
                    storage.remove('CHEAT_COUNT');
                    storage.set('GOD_MODE', 'true');
                    
                    el.clickBtn.disabled = false;
                    el.earth.style.pointerEvents = 'auto';
                    el.godModeBadge.style.display = 'block';
                    
                    if (state.playerRef) {
                        state.playerRef.update({
                            banned: false,
                            cheatCount: 0,
                            godMode: true
                        });
                    }
                    
                    el.cheaterAlert.style.display = 'none';
                    
                    console.log('%cüëë –†–ï–ñ–ò–ú –°–û–ó–î–ê–¢–ï–õ–Ø –ê–ö–¢–ò–í–ò–†–û–í–ê–ù', 'color: gold; font-size: 16px; font-weight: bold');
                    alert('üëë –†–µ–∂–∏–º —Å–æ–∑–¥–∞—Ç–µ–ª—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!');
                },
                
                // –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–∫–∏
                addClicks(amount) {
                    if (!state.godMode) {
                        console.warn('‚ùå –¢–æ–ª—å–∫–æ –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è!');
                        return;
                    }
                    
                    for (let i = 0; i < amount; i++) {
                        setTimeout(() => {
                            simulateClick();
                        }, i * 10);
                    }
                    
                    console.log(`‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} –∫–ª–∏–∫–æ–≤`);
                },
                
                // –°–±—Ä–æ—Å –∏–≥—Ä—ã
                resetGame() {
                    if (!state.godMode) return;
                    
                    if (confirm('‚ö†Ô∏è –¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')) {
                        localStorage.clear();
                        db.ref('globalCounter').set(0);
                        db.ref('players').remove();
                        db.ref('onlineUsers').remove();
                        location.reload();
                    }
                },
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                showStats() {
                    if (!state.godMode) return;
                    
                    console.log('üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–û–ó–î–ê–¢–ï–õ–Ø:');
                    console.log('–ò–≥—Ä–æ–∫:', state.username);
                    console.log('–°—á–µ—Ç:', state.score);
                    console.log('ID:', state.playerId);
                    console.log('–ß–∏—Ç–µ—Ä—Å—Ç–≤–æ:', state.cheatCount);
                    console.log('–ë–∞–Ω:', state.banned);
                    console.log('–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤:', Object.keys(state.allPlayers).length);
                    console.log('–ó–∞–±–∞–Ω–µ–Ω–æ:', Object.values(state.allPlayers).filter(p => p.banned).length);
                }
            };

            // –°–∏–º—É–ª—è—Ü–∏—è –∫–ª–∏–∫–∞
            function simulateClick() {
                if (state.godMode) {
                    handleClick();
                }
            }

            // ===== –ê–Ω—Ç–∏-—á–∏—Ç —Å–∏—Å—Ç–µ–º–∞ =====
            const antiCheat = {
                checkAutoClicker() {
                    if (state.godMode) return true;
                    if (state.banned) return false;
                    
                    const now = Date.now();
                    const oneSecondAgo = now - 1000;
                    const oneMinuteAgo = now - 60000;
                    
                    const clicksLastSecond = state.clickTimes.filter(t => t > oneSecondAgo).length;
                    const clicksLastMinute = state.clickTimes.filter(t => t > oneMinuteAgo).length;
                    
                    if (clicksLastSecond > CONFIG.LIMITS.MAX_CLICKS_PER_SECOND) {
                        this.recordCheat('–°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∫–ª–∏–∫–∏');
                        return false;
                    }
                    
                    if (clicksLastMinute > CONFIG.LIMITS.MAX_CLICKS_PER_MINUTE) {
                        this.recordCheat('–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∫–ª–∏–∫–æ–≤ –≤ –º–∏–Ω—É—Ç—É');
                        return false;
                    }
                    
                    return true;
                },
                
                checkScoreHack() {
                    if (state.godMode) return true;
                    if (state.banned) return false;
                    
                    const now = Date.now();
                    const timeDiff = now - state.lastCheck;
                    
                    if (timeDiff > CONFIG.LIMITS.CHECK_INTERVAL) {
                        const scoreDiff = state.score - state.lastScore;
                        
                        if (scoreDiff > CONFIG.LIMITS.MAX_SCORE_GROWTH) {
                            this.recordCheat('–ê–Ω–æ–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç —Å—á–µ—Ç–∞');
                            return false;
                        }
                        
                        state.lastScore = state.score;
                        state.lastCheck = now;
                    }
                    
                    return true;
                },
                
                recordCheat(reason) {
                    if (state.godMode) {
                        console.log('üëë –°–æ–∑–¥–∞—Ç–µ–ª—å —á–∏—Ç–µ—Ä–∏—Ç:', reason);
                        return;
                    }
                    
                    console.warn('üö´ –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —á–∏—Ç–µ—Ä—Å—Ç–≤–æ:', reason);
                    
                    state.cheatCount++;
                    storage.set('CHEAT_COUNT', state.cheatCount.toString());
                    
                    el.cheaterAlert.style.display = 'block';
                    setTimeout(() => {
                        el.cheaterAlert.style.display = 'none';
                    }, 3000);
                    
                    if (state.cheatCount >= CONFIG.LIMITS.BAN_THRESHOLD) {
                        this.banPlayer(reason);
                    }
                },
                
                banPlayer(reason) {
                    if (state.godMode) return;
                    
                    state.banned = true;
                    
                    el.clickBtn.disabled = true;
                    el.earth.style.pointerEvents = 'none';
                    
                    el.cheaterAlert.style.display = 'block';
                    el.cheaterAlert.style.background = '#8B0000';
                    el.cheaterAlert.textContent = 'üö´ –í—ã –∑–∞–±–∞–Ω–µ–Ω—ã –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Ç–æ–≤';
                    
                    if (state.onlineRef) {
                        state.onlineRef.remove();
                    }
                    
                    if (state.playerRef) {
                        state.playerRef.update({ 
                            banned: true, 
                            cheatCount: state.cheatCount,
                            banReason: reason,
                            banTime: Date.now()
                        }).then(() => {
                            // –£–≤–µ–¥–æ–º–ª—è–µ–º —Å–æ–∑–¥–∞—Ç–µ–ª—è
                            if (state.godMode) {
                                creatorPanel.notifyNewBan(state.username);
                            }
                        });
                    }
                    
                    console.error('–ò–≥—Ä–æ–∫ –∑–∞–±–∞–Ω–µ–Ω');
                },
                
                validateClick() {
                    if (state.godMode) return true;
                    if (state.banned) return false;
                    
                    return this.checkAutoClicker() && this.checkScoreHack();
                },
                
                cleanup() {
                    const now = Date.now();
                    state.clickTimes = state.clickTimes.filter(t => t > now - 120000);
                }
            };

            // ===== UI –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ =====
            function updateUI() {
                if (state.banned && !state.godMode) return;
                
                if (state.nameSet && state.username) {
                    el.nameInputGroup.classList.add('hidden');
                    el.greeting.classList.remove('hidden');
                    el.displayName.textContent = state.username;
                    el.clickBtn.disabled = state.banned && !state.godMode;
                } else {
                    el.nameInputGroup.classList.remove('hidden');
                    el.greeting.classList.add('hidden');
                    el.clickBtn.disabled = true;
                }

                const percent = Math.min((state.score / CONFIG.TARGET) * 100, 100);
                el.earthFill.style.height = percent + '%';
                el.earthImage.style.opacity = percent / 100;
                el.progressFill.style.width = percent + '%';
                
                if (percent < 30) {
                    el.earthFill.style.background = 'linear-gradient(180deg, #4CAF50, #2E7D32)';
                } else if (percent < 70) {
                    el.earthFill.style.background = 'linear-gradient(180deg, #FFC107, #FF8F00)';
                } else {
                    el.earthFill.style.background = 'linear-gradient(180deg, #FF5722, #BF360C)';
                }

                el.counter.textContent = state.score.toLocaleString();
                el.currentPop.textContent = state.score.toLocaleString();
                el.remaining.textContent = Math.max(CONFIG.TARGET - state.score, 0).toLocaleString();
                el.userScore.textContent = (state.playerRef ? state.score : 0).toLocaleString();
            }

            // ===== Firebase =====
            function initFirebase() {
                db.ref('globalCounter').on('value', snap => {
                    if (!state.banned || state.godMode) {
                        state.score = snap.val() || 0;
                        updateUI();
                    }
                });

                db.ref('lastClick').on('value', snap => {
                    if (!state.banned || state.godMode) {
                        const data = snap.val();
                        el.lastClickerName.textContent = data?.name || '–Ω–∏–∫—Ç–æ';
                    }
                });

                db.ref('onlineUsers').on('value', snap => {
                    if (!state.banned || state.godMode) {
                        const count = snap.val() ? Object.keys(snap.val()).length : 0;
                        el.onlineCount.textContent = count;
                        if (state.godMode) {
                            el.totalOnline.textContent = count;
                        }
                    }
                });

                db.ref('players').on('value', snap => {
                    const players = snap.val() || {};
                    state.allPlayers = players;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ø
                    if (!state.banned || state.godMode) {
                        const list = Object.entries(players)
                            .map(([id, data]) => ({ id, ...data }))
                            .filter(p => p.score > 0 && !p.banned)
                            .sort((a, b) => b.score - a.score)
                            .slice(0, 10);

                        if (!list.length) {
                            el.topList.innerHTML = '<div class="top-item">–ü–æ–∫–∞ –Ω–µ—Ç –∫–ª–∏–∫–æ–≤</div>';
                        } else {
                            el.topList.innerHTML = list.map((p, i) => {
                                const rankClass = i === 0 ? 'top-rank-1' : i === 1 ? 'top-rank-2' : i === 2 ? 'top-rank-3' : '';
                                const isCurrent = p.id === state.playerId;
                                return `
                                    <div class="top-item ${isCurrent ? 'current' : ''}">
                                        <div class="top-rank ${rankClass}">${i + 1}</div>
                                        <span class="top-name">${p.name || '–ê–Ω–æ–Ω–∏–º'}</span>
                                        <span class="top-score">${p.score.toLocaleString()}</span>
                                    </div>
                                `;
                            }).join('');
                        }
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —Å–æ–∑–¥–∞—Ç–µ–ª—è
                    if (state.godMode) {
                        creatorPanel.updateBannedList();
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
                    if (state.playerId && players[state.playerId] && (!state.banned || state.godMode)) {
                        const fbScore = players[state.playerId].score || 0;
                        if (fbScore !== state.score) {
                            state.score = fbScore;
                            storage.set('SCORE', fbScore);
                            updateUI();
                        }
                    }
                });
            }

            // ===== –ò–≥—Ä–æ–∫ =====
            function initPlayer() {
                state.godMode = storage.get('GOD_MODE') === 'true';
                if (state.godMode) {
                    el.godModeBadge.style.display = 'block';
                }
                
                state.nameSet = storage.get('NAME_SET') === 'true';
                state.username = storage.get('NAME') || '';
                state.playerId = storage.get('ID') || null;
                state.score = parseInt(storage.get('SCORE') || '0');
                state.cheatCount = parseInt(storage.get('CHEAT_COUNT') || '0');
                
                if (state.cheatCount >= CONFIG.LIMITS.BAN_THRESHOLD && state.godMode) {
                    state.banned = false;
                    state.cheatCount = 0;
                } else if (state.cheatCount >= CONFIG.LIMITS.BAN_THRESHOLD) {
                    antiCheat.banPlayer('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–Ω');
                    return;
                }

                if (state.username) el.username.value = state.username;

                if (state.nameSet && state.playerId) {
                    db.ref('players/' + state.playerId).once('value').then(snap => {
                        if (snap.exists() && (!state.banned || state.godMode)) {
                            const data = snap.val();
                            state.playerRef = db.ref('players/' + state.playerId);
                            
                            if (data.banned && !state.godMode) {
                                antiCheat.banPlayer('–ë–∞–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö');
                                return;
                            }
                            
                            if (data.score < state.score) {
                                state.playerRef.update({ 
                                    score: state.score, 
                                    name: state.username,
                                    lastSeen: Date.now()
                                });
                            } else {
                                state.score = data.score;
                                storage.set('SCORE', data.score);
                            }
                        } else if (!state.banned || state.godMode) {
                            createNewPlayer();
                        }
                        updateUI();
                    });
                } else if (state.nameSet && (!state.banned || state.godMode)) {
                    createNewPlayer();
                }

                updateUI();
            }

            function createNewPlayer() {
                if (state.banned && !state.godMode) return;
                
                const newRef = db.ref('players').push();
                newRef.set({
                    name: state.username,
                    score: state.score,
                    joined: Date.now(),
                    lastSeen: Date.now(),
                    cheatCount: state.cheatCount,
                    banned: state.banned || false,
                    godMode: state.godMode || false
                });
                state.playerRef = newRef;
                state.playerId = newRef.key;
                storage.set('ID', state.playerId);
            }

            // ===== –û–Ω–ª–∞–π–Ω =====
            function initOnline() {
                if (state.banned && !state.godMode) return;
                
                state.onlineRef = db.ref('onlineUsers').push();
                state.onlineRef.set({
                    name: state.username || '–ê–Ω–æ–Ω–∏–º',
                    online: true,
                    lastSeen: Date.now(),
                    playerId: state.playerId,
                    godMode: state.godMode || false
                });

                window.addEventListener('beforeunload', () => {
                    if (state.onlineRef) state.onlineRef.remove();
                    if (state.playerRef && (!state.banned || state.godMode)) {
                        state.playerRef.update({ 
                            lastSeen: Date.now(), 
                            online: false,
                            cheatCount: state.cheatCount
                        });
                        storage.set('SCORE', state.score);
                    }
                });
            }

            // ===== –ö–ª–∏–∫ =====
            async function handleClick() {
                if (!antiCheat.validateClick()) return;
                
                state.clickTimes.push(Date.now());
                antiCheat.cleanup();

                try {
                    const result = await db.ref('globalCounter').transaction(v => (v || 0) + 1);
                    if (result.committed) {
                        await db.ref('lastClick').set({ 
                            name: state.username, 
                            timestamp: Date.now(),
                            playerId: state.playerId,
                            godMode: state.godMode || false
                        });
                        
                        if (state.playerRef && (!state.banned || state.godMode)) {
                            const playerResult = await state.playerRef.transaction(p => {
                                if (!p) p = { score: 0 };
                                p.score = (p.score || 0) + 1;
                                p.name = state.username;
                                p.lastSeen = Date.now();
                                p.cheatCount = state.cheatCount;
                                p.godMode = state.godMode || false;
                                return p;
                            });
                            
                            if (playerResult.committed) {
                                state.score = playerResult.snapshot.val().score;
                                storage.set('SCORE', state.score);
                            }
                        }

                        if (result.snapshot.val() >= CONFIG.TARGET) {
                            alert('üéâ –ú–´ –ó–ê–°–ï–õ–ò–õ–ò –ó–ï–ú–õ–Æ! üéâ');
                        }
                    }
                } catch (e) {
                    console.error('Click error:', e);
                }
            }

            // ===== –ò–º—è =====
            function setName() {
                const name = el.username.value.trim();
                if (!name) return alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è');

                state.username = name;
                state.nameSet = true;
                
                storage.set('NAME', name);
                storage.set('NAME_SET', 'true');

                createNewPlayer();
                updateUI();
            }

            // ===== –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–∞–Ω–µ–ª–∏ =====
            el.creatorPanelBtn.addEventListener('click', () => {
                if (state.godMode) {
                    creatorPanel.open();
                } else {
                    // –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –≤ —Ä–µ–∂–∏–º —Å–æ–∑–¥–∞—Ç–µ–ª—è
                    const secret = prompt('–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥ —Å–æ–∑–¥–∞—Ç–µ–ª—è:');
                    if (secret === CONFIG.CREATOR_SECRET) {
                        creatorTools.unbanMyself();
                        setTimeout(() => creatorPanel.open(), 500);
                    } else if (secret) {
                        alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!');
                    }
                }
            });

            el.closePanel.addEventListener('click', () => creatorPanel.close());
            el.backdrop.addEventListener('click', () => creatorPanel.close());

            // ===== –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã =====
            window.unbanMe = function(secret) {
                if (secret === CONFIG.CREATOR_SECRET) {
                    creatorTools.unbanMyself();
                } else {
                    console.warn('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥!');
                }
            };

            window.creator = {
                unban: () => creatorTools.unbanMyself(),
                addClicks: (amount) => creatorTools.addClicks(amount),
                reset: () => creatorTools.resetGame(),
                stats: () => creatorTools.showStats(),
                panel: () => creatorPanel.open(),
                secret: CONFIG.CREATOR_SECRET
            };

            console.log(
                '%cüëë –°–ï–ö–†–ï–¢–ù–´–ï –ö–û–ú–ê–ù–î–´:\n%cunbanMe("ILoveMyGame")\n\n–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –æ–±—ä–µ–∫—Ç creator:\ncreator.unban() - —Ä–∞–∑–±–∞–Ω\ncreator.panel() - –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å\ncreator.addClicks(100) - –¥–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–∫–∏', 
                'color: gold; font-size: 14px; font-weight: bold',
                'color: #4CAF50; font-size: 12px;'
            );

            // ===== –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ =====
            setInterval(() => {
                if (state.banned && !state.godMode) return;
                
                antiCheat.checkScoreHack();
                antiCheat.cleanup();
                
                if (state.onlineRef) {
                    state.onlineRef.update({ 
                        lastSeen: Date.now(), 
                        name: state.username || '–ê–Ω–æ–Ω–∏–º',
                        cheatCount: state.cheatCount,
                        godMode: state.godMode || false
                    });
                }
                
                if (state.playerRef && state.nameSet && (!state.banned || state.godMode)) {
                    state.playerRef.update({ 
                        lastSeen: Date.now(), 
                        name: state.username,
                        cheatCount: state.cheatCount,
                        godMode: state.godMode || false
                    });
                    storage.set('SCORE', state.score);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞
                if (state.godMode && el.creatorPanel.classList.contains('show')) {
                    creatorPanel.updateBannedList();
                }
            }, 15000);

            // ===== –ó–∞–ø—É—Å–∫ =====
            function init() {
                state.cheatCount = parseInt(storage.get('CHEAT_COUNT') || '0');
                
                initFirebase();
                initPlayer();
                initOnline();
                
                el.saveNameBtn.addEventListener('click', setName);
                el.username.addEventListener('keypress', e => e.key === 'Enter' && setName());
                el.clickBtn.addEventListener('click', handleClick);
                el.earth.addEventListener('click', handleClick);
                
                console.log('‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞');
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
    </script>
</body>
</html>